<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KittyScripts</title>

<link rel="icon" type="image/webp"
href="https://raw.githubusercontent.com/zxkuhl/KittyScriptsWeb/main/KapiNewestIcon.webp">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    background: #0b0b0b;
    font-family: Arial, Helvetica, sans-serif;
    color: white;
}

.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #111;
    padding: 10px 20px;
}

.tabs { display: flex; }

.tab {
    padding: 10px 20px;
    cursor: pointer;
    border-radius: 6px;
}
.tab.active { background: #5865F2; }

.discord-btn {
    background: #5865F2;
    border: none;
    padding: 10px 15px;
    color: white;
    border-radius: 8px;
    cursor: pointer;
}

.content { text-align: center; margin-top: 40px; }

.script-card {
    background: #111;
    border: 1px solid #222;
    padding: 20px;
    margin: 15px auto;
    width: 320px;
    border-radius: 10px;
}

.script-card button {
    margin-top: 10px;
    padding: 8px 15px;
    background: #5865F2;
    border: none;
    color: white;
    border-radius: 6px;
    cursor: pointer;
}

.add-btn {
    font-size: 30px;
    background: #5865F2;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: none;
    color: white;
    cursor: pointer;
}

/* POPUPS */
.popup {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    display: none;
    align-items: center;
    justify-content: center;
}

.popup-content {
    background: #111;
    padding: 20px;
    border-radius: 10px;
    width: 300px;
}

.popup input, .popup textarea {
    width: 100%;
    margin: 8px 0;
    padding: 8px;
    background: #222;
    border: none;
    color: white;
}
</style>
</head>

<body>

<div class="navbar">
    <div class="tabs">
        <div class="tab active" onclick="showTab('main')">Main</div>
        <div class="tab" onclick="showTab('scripts')">Scripts</div>
    </div>
    <button class="discord-btn" onclick="window.location.href='https://discord.gg/KPUPp4m9pJ'">
        Discord
    </button>
</div>

<div class="content">
    <div id="mainTab">
        <h1>KittyScripts</h1>
        <img width="220"
        src="https://raw.githubusercontent.com/zxkuhl/KittyScriptsWeb/main/KapiNewestIcon.webp">
        <p>Script hub • simple • clean</p>
    </div>

    <div id="scriptsTab" style="display:none;">
        <h2>Scripts</h2>
        <button class="add-btn" onclick="openPasswordPopup()">+</button>
        <div id="scriptsContainer"></div>
    </div>
</div>

<!-- PASSWORD POPUP -->
<div class="popup" id="passwordPopup">
    <div class="popup-content">
        <h3>Admin Login</h3>
        <input type="password" id="adminPass" placeholder="Password">
        <button onclick="checkPassword()">Enter</button>
    </div>
</div>

<!-- ADD SCRIPT POPUP -->
<div class="popup" id="addPopup">
    <div class="popup-content">
        <h3>Add Script</h3>
        <input id="scriptName" placeholder="Script name">
        <textarea id="scriptCode" placeholder="Script code"></textarea>
        <button onclick="addScript()">Add</button>
    </div>
</div>

<!-- FIREBASE + LOGIC -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyA7sKnlRbrecC-K591ELNJb27Wl_kwZXAc",
  authDomain: "kittyscriptsweb.firebaseapp.com",
  projectId: "kittyscriptsweb",
  storageBucket: "kittyscriptsweb.appspot.com",
  messagingSenderId: "866548422450",
  appId: "1:866548422450:web:a327c122f0d8e57fa1e92b"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const ADMIN_PASSWORDS = ["i miss m.", "avalarson"];

window.showTab = (tab) => {
    mainTab.style.display = tab === "main" ? "block" : "none";
    scriptsTab.style.display = tab === "scripts" ? "block" : "none";
};

window.openPasswordPopup = () => passwordPopup.style.display = "flex";
window.checkPassword = () => {
    if (!ADMIN_PASSWORDS.includes(adminPass.value)) {
        alert("Wrong password");
        return;
    }
    passwordPopup.style.display = "none";
    addPopup.style.display = "flex";
};

window.addScript = () => {
    push(ref(db, "scripts"), {
        name: scriptName.value,
        code: scriptCode.value
    });
    addPopup.style.display = "none";
};

onValue(ref(db, "scripts"), snap => {
    scriptsContainer.innerHTML = "";
    snap.forEach(child => {
        const s = child.val();
        scriptsContainer.innerHTML += `
            <div class="script-card">
                <strong>${s.name}</strong>
                <p>${s.code}</p>
                <button onclick="navigator.clipboard.writeText('${s.code}')">
                    Copy Script
                </button>
            </div>`;
    });
});
</script>

</body>
</html>
